      var_notify_doors: |
        [[[
          try {
            const entityName = variables.var_entity_name;
            if (!entityName || entityName === 'none') return 'door=;words=Vsa vrata so zaprta';

            const doorPrefix = 'switch.' + entityName + '_door';

            const doors = Object.values(states).filter(entity =>
              entity.entity_id.startsWith(doorPrefix)
            );

            let hasUnknown = false;
            let hasUnavailable = false;

            for (const entity of doors) {
              if (entity.state === 'unknown') hasUnknown = true;
              else if (entity.state === 'unavailable') hasUnavailable = true;
            }

            let doorResult = '';
            if (hasUnknown && hasUnavailable) doorResult = 'E3';
            else if (hasUnknown) doorResult = 'E1';
            else if (hasUnavailable) doorResult = 'E2';
            else {
              const count = doors.filter(entity => entity.state === 'on').length;
              doorResult = count > 0 ? count.toString() : '';
            }

            let wordsResult = '';
            if (doorResult === '') wordsResult = 'Vsa vrata so zaprta';
            else if (doorResult === 'E1') wordsResult = 'Napaka: eno ali več vrat je v stanju "unknown"';
            else if (doorResult === 'E2') wordsResult = 'Napaka: eno ali več vrat je v stanju "unavailable"';
            else if (doorResult === 'E3') wordsResult = 'Napaka: vrata so v stanju "unknown" in "unavailable"';
            else {
              const num = parseInt(doorResult);
              if (isNaN(num)) wordsResult = `NAPAKA: var_notify_door ni število (${doorResult})`;
              else if (num === 1) wordsResult = 'Ena vrata so odprta';
              else if (num === 2) wordsResult = 'Dvoje vrat sta odprta';
              else if (num === 3) wordsResult = 'Troje vrat so odprta';
              else wordsResult = `${num} vrat je odprtih`;
            }

            return `door=${doorResult};words=${wordsResult}`;
          } catch (e) {
            return `door=;words=NAPAKA: ${e.message}`;
          }
        ]]]
